
getgenv().slient = false
getgenv().esp = false

local OrionLib = loadstring(game:HttpGet(('https://raw.githubusercontent.com/Sigma-3131/Scripts/refs/heads/main/Orion%20Optimized')))()



local localPlayer = game:GetService("Players").LocalPlayer
local currentCamera = game:GetService("Workspace").CurrentCamera
local mouse = localPlayer:GetMouse()
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

local function getClosestPlayerToCursor(x, y)
    local closestPlayer = nil
    local shortestDistance = math.huge

    for i, v in pairs(game:GetService("Players"):GetPlayers()) do
        if v ~= localPlayer and v.Character and v.Character:FindFirstChild("Humanoid")
        and v.Character.Humanoid.Health ~= 0
        and v.Character:FindFirstChild("HumanoidRootPart")
        and v.Character:FindFirstChild("Torso") then

            local pos = currentCamera:WorldToViewportPoint(v.Character.HumanoidRootPart.Position)
            local magnitude = (Vector2.new(pos.X, pos.Y) - Vector2.new(x, y)).Magnitude

            if magnitude < shortestDistance then
                closestPlayer = v
                shortestDistance = magnitude
            end
        end
    end

    return closestPlayer
end

local mt = getrawmetatable(game)
local oldIndex = mt.__index
if setreadonly then setreadonly(mt, false) else make_writeable(mt, true) end
local newClose = newcclosure or function(f) return f end

mt.__index = newClose(function(t, k)
    if getgenv().slient == true
    and not checkcaller()
    and t == mouse
    and tostring(k) == "X"
    and string.find(getfenv(2).script.Name, "Client")
    and getClosestPlayerToCursor() then

        local closest = getClosestPlayerToCursor(oldIndex(t, k), oldIndex(t, "Y")).Character.HumanoidRootPart
        local pos = currentCamera:WorldToScreenPoint(closest.Position)
        return pos.X
    end

    if getgenv().slient == true
    and not checkcaller()
    and t == mouse
    and tostring(k) == "Y"
    and string.find(getfenv(2).script.Name, "Client")
    and getClosestPlayerToCursor() then

        local closest = getClosestPlayerToCursor(oldIndex(t, "X"), oldIndex(t, k)).Character.HumanoidRootPart
        local pos = currentCamera:WorldToScreenPoint(closest.Position)
        return pos.Y
    end

    if getgenv().slient == true
    and t == mouse
    and tostring(k) == "Hit"
    and string.find(getfenv(2).script.Name, "Client")
    and getClosestPlayerToCursor() then

        return getClosestPlayerToCursor(mouse.X, mouse.Y).Character.HumanoidRootPart.CFrame
    end

    return oldIndex(t, k)
end)

if setreadonly then setreadonly(mt, true) else make_writeable(mt, false) end




local function removeESP(char)
    if not char then return end

    local h = char:FindFirstChild("ESP_Highlight")
    if h then h:Destroy() end

    local head = char:FindFirstChild("Head")
    if head then
        local n = head:FindFirstChild("NameESP")
        if n then n:Destroy() end
    end
end

local function applyESP(char, player)
    if not getgenv().esp then
        removeESP(char)
        return
    end

    if not char then return end
    if player == LocalPlayer then return end

    if not char:FindFirstChild("ESP_Highlight") then
        local highlight = Instance.new("Highlight")
        highlight.Name = "ESP_Highlight"
        highlight.FillColor = Color3.fromRGB(255, 255, 255)
        highlight.OutlineColor = Color3.fromRGB(255, 255, 255)
        highlight.FillTransparency = 0.5
        highlight.OutlineTransparency = 0.45
        highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
        highlight.Parent = char
    end

    local head = char:WaitForChild("Head", 5)
    if head and not head:FindFirstChild("NameESP") then
        local billboard = Instance.new("BillboardGui")
        billboard.Name = "NameESP"
        billboard.Size = UDim2.new(0, 80, 0, 15)
        billboard.AlwaysOnTop = true
        billboard.StudsOffset = Vector3.new(0, 2.5, 0)
        billboard.Parent = head

        local label = Instance.new("TextLabel")
        label.Size = UDim2.new(1, 0, 1, 0)
        label.BackgroundTransparency = 1
        label.Text = player.Name
        label.TextColor3 = Color3.fromRGB(255, 255, 255)
        label.TextStrokeTransparency = 0.3
        label.TextScaled = false
        label.TextSize = 12
        label.Font = Enum.Font.GothamBold
        label.Parent = billboard
    end
end

local function onCharacter(player)
    player.CharacterAdded:Connect(function(char)
        char:WaitForChild("Head", 5)
        applyESP(char, player)
    end)

    if player.Character then
        applyESP(player.Character, player)
    end
end

for _, plr in ipairs(Players:GetPlayers()) do
    onCharacter(plr)
end

Players.PlayerAdded:Connect(onCharacter)

task.spawn(function()
    local last = getgenv().esp
    while true do
        if last ~= getgenv().esp then
            last = getgenv().esp
            for _, plr in ipairs(Players:GetPlayers()) do
                if plr.Character then
                    applyESP(plr.Character, plr)
                end
            end
        end
        task.wait(0.2)
    end
end)

local Window = OrionLib:MakeWindow({Name = "Title of the library", HidePremium = false, SaveConfig = true, ConfigFolder = "OrionTest"})

local Tab = Window:MakeTab({
	Name = "Gaming Chair",
	Icon = "rbxassetid://4483345998",
	PremiumOnly = false
})

local Section = Tab:AddSection({
	Name = "Doldi"
})

Tab:AddToggle({
	Name = "Slient Aim",
	Default = false,
	Callback = function(c)
		getgenv().slient = c
	end    
})

Tab:AddToggle({
	Name = "ESP",
	Default = false,
	Callback = function(q)
		getgenv().esp = q
	end    
})


